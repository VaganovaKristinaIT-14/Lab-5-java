import java.util.*;
import java.io.*;
import java.util.stream.Collectors;

public class PersonProcessor {

  public static Map<Integer, List<String>> processPeople(String filename) {
    try (BufferedReader reader = new BufferedReader(new FileReader(filename))) {
      return reader.lines()
          .map(line -> line.split(":"))
          .filter(parts -> parts.length == 2)
          .filter(parts -> !parts[1].trim().isEmpty())
          .collect(Collectors.groupingBy(
              parts -> Integer.parseInt(parts[1].trim()),
              Collectors.mapping(
                  parts -> {
                    String name = parts[0].trim();
                    if (name.isEmpty()) {
                      return "";
                    }
                    return name.substring(0, 1).toUpperCase() +
                        name.substring(1).toLowerCase();
                  },
                  Collectors.toList()
              )
          ));
    } catch (IOException e) {
      System.out.println("Ошибка чтения файла: " + e.getMessage());
      return new HashMap<>();
    }
  }
}
